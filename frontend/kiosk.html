<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Staff Kiosk - Clock In/Out</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/luxon@3/build/global/luxon.min.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#3b82f6',
            secondary: '#1e40af',
          }
        }
      }
    }
  </script>
  <style>
    body {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    }

    /* Staff Card Status Animations */
    .staff-card {
      position: relative;
      transition: all 0.3s ease;
    }

    /* Border Glow States with Gradient */
    .staff-card.status-active {
      border: 3px solid transparent;
      background-image: linear-gradient(white, white),
        linear-gradient(135deg, #4ade80, #16a34a, #15803d);
      background-origin: border-box;
      background-clip: padding-box, border-box;
      box-shadow: 0 0 20px rgba(22, 163, 74, 0.4);
      animation: pulseGreen 2s ease-in-out infinite;
      transform: scale(1.02);
    }

    .staff-card.status-break {
      border: 3px solid transparent;
      background-image: linear-gradient(white, white),
        linear-gradient(135deg, #fb923c, #f97316, #ea580c);
      background-origin: border-box;
      background-clip: padding-box, border-box;
      box-shadow: 0 0 20px rgba(249, 115, 22, 0.4);
      animation: pulseOrange 3s ease-in-out infinite;
      transform: scale(1.02);
    }

    .staff-card.status-idle {
      border: 2px solid #d1d5db;
    }

    /* Pulse Animations */
    @keyframes pulseGreen {
      0%, 100% {
        box-shadow: 0 0 20px rgba(22, 163, 74, 0.4);
      }
      50% {
        box-shadow: 0 0 30px rgba(22, 163, 74, 0.7);
      }
    }

    @keyframes pulseOrange {
      0%, 100% {
        box-shadow: 0 0 20px rgba(249, 115, 22, 0.4);
      }
      50% {
        box-shadow: 0 0 30px rgba(249, 115, 22, 0.7);
      }
    }

    /* Status Badge */
    .status-badge {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      border: 2px solid white;
      z-index: 10;
    }

    .status-badge.active {
      background-color: #16a34a;
    }

    .status-badge.break {
      background-color: #f97316;
    }

    .status-badge.idle {
      background-color: #9ca3af;
    }

    /* Time Overlay */
    .time-overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 6px 8px;
      font-size: 0.75rem;
      text-align: center;
      border-radius: 0 0 0.75rem 0.75rem;
    }

    /* Idle Screen Overlay */
    .idle-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      cursor: pointer;
    }

    /* Step 5: System Status Indicator */
    .status-indicator {
      position: fixed;
      bottom: 10px;
      right: 10px;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      color: white;
      background: #198754;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .status-indicator::before {
      content: '';
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: currentColor;
      animation: pulse 2s ease-in-out infinite;
    }

    .status-indicator.offline {
      background: #dc3545;
    }

    .status-indicator.offline::before {
      animation: none;
    }

    .status-indicator.syncing {
      background: #ffc107;
      color: #000;
    }

    .status-indicator.syncing::before {
      animation: spin 1s linear infinite;
    }

    /* Step 6: Paused state */
    .status-indicator.paused {
      background: #6c757d;
      color: #fff;
    }

    .status-indicator.paused::before {
      animation: none;
      opacity: 0.6;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body class="min-h-screen">
  <!-- Header -->
  <nav class="bg-slate-800 shadow-lg mb-6">
    <div class="container mx-auto px-4">
      <div class="flex items-center justify-between h-16">
        <a class="flex items-center text-white" href="#">
          <i class="bi bi-people-fill text-3xl mr-3"></i>
          <span class="text-xl font-bold">Staff Kiosk</span>
        </a>
        <div class="flex items-center gap-4">
          <div id="venueClock" class="text-white text-lg font-semibold"></div>
          <span class="text-white" id="venueName">Loading...</span>
          <button class="hidden px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-all duration-200" id="logoutBtn">
            <i class="bi bi-box-arrow-right mr-2"></i>Logout
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Offline Banner -->
  <div id="offlineBanner" style="display:none; background:#dc2626; color:#fff; padding:12px; text-align:center; font-weight:600; box-shadow: 0 2px 8px rgba(0,0,0,0.15);">
    <i class="bi bi-exclamation-triangle-fill mr-2"></i>⚠️ Backend Unavailable — Actions will be queued and synced when backend is restored
  </div>

  <div class="container mx-auto px-4 max-w-7xl">
    <!-- Kiosk Login Form -->
    <div id="kioskLogin" class="max-w-md mx-auto">
      <div class="bg-white rounded-2xl shadow-2xl p-8">
        <h3 class="text-3xl font-bold text-center mb-6 text-slate-800">
          <i class="bi bi-door-open mr-2"></i>Kiosk Login
        </h3>
        <div class="mb-4">
          <input
            id="kioskUsername"
            placeholder="Venue Email"
            class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-blue-500 transition-all"
            autocomplete="username"
            type="email">
        </div>
        <div class="mb-6">
          <input
            id="kioskPassword"
            placeholder="Kiosk Password"
            type="password"
            class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-blue-500 transition-all"
            autocomplete="current-password">
        </div>
        <button class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-xl transition-all duration-200 transform hover:scale-105" id="kioskLoginButton">
          <i class="bi bi-unlock mr-2"></i>Login
        </button>
        <div id="kioskLoginError" class="mt-4"></div>
      </div>
    </div>

    <!-- Kiosk Panel (hidden by default) -->
    <div id="kioskPanel" class="hidden">
      <!-- Staff Grid -->
      <div id="staffGrid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 mb-4"></div>

      <!-- Status Legend -->
      <div id="statusLegend" class="bg-white rounded-xl shadow-lg p-4 mb-6 flex items-center justify-center gap-6 text-sm">
        <div class="flex items-center gap-2">
          <span class="inline-block w-3 h-3 rounded-full bg-green-600"></span>
          <span class="text-gray-700">Active</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="inline-block w-3 h-3 rounded-full bg-orange-500"></span>
          <span class="text-gray-700">On Break</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="inline-block w-3 h-3 rounded-full bg-gray-400"></span>
          <span class="text-gray-700">Inactive</span>
        </div>
      </div>

      <!-- PIN Entry Modal -->
      <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="pinModal">
        <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4">
          <h3 class="text-2xl font-bold text-center mb-4 text-slate-800">
            <i class="bi bi-shield-lock mr-2"></i>Enter Your PIN
          </h3>
          <p class="text-center text-gray-600 mb-6" id="pinStaffName">Staff Member</p>

          <!-- PIN Input -->
          <div class="mb-6">
            <input
              type="password"
              id="pinInput"
              maxlength="6"
              pattern="[0-9]{6}"
              placeholder="Enter 6-digit PIN"
              class="w-full px-6 py-4 text-center text-3xl font-mono border-4 border-gray-300 rounded-xl focus:outline-none focus:border-blue-500 transition-all tracking-widest"
              autocomplete="off"
              inputmode="numeric">
            <div class="text-sm text-gray-500 text-center mt-2">6-digit numeric PIN</div>
          </div>

          <!-- Error Message -->
          <div id="pinError" class="hidden mb-4 px-4 py-3 bg-red-100 text-red-800 rounded-xl text-center font-semibold"></div>

          <!-- Buttons -->
          <div class="grid grid-cols-2 gap-4">
            <button id="pinCancelBtn" class="px-6 py-3 bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold rounded-xl transition-all">
              <i class="bi bi-x-circle mr-2"></i>Cancel
            </button>
            <button id="pinSubmitBtn" class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl transition-all">
              <i class="bi bi-check-circle mr-2"></i>Submit
            </button>
          </div>
        </div>
      </div>

      <!-- Clock Section -->
      <div class="hidden bg-white rounded-2xl shadow-2xl overflow-hidden max-w-2xl mx-auto" id="clockSection">
        <div class="bg-blue-600 text-white px-6 py-4 flex items-center justify-between">
          <h5 class="text-xl font-bold flex items-center">
            <i class="bi bi-clock mr-2"></i>
            <span id="selectedStaffName">Staff Member</span>
          </h5>
          <button class="px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-all" id="backToStaffListBtn">
            <i class="bi bi-arrow-left mr-2"></i> Back
          </button>
        </div>
        <div class="p-6">
          <!-- Status -->
          <div class="mb-6">
            <div id="statusDisplay" class="px-6 py-4 bg-blue-100 text-blue-800 rounded-xl text-center font-semibold">
              Loading status...
            </div>
          </div>

          <!-- Buttons -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <button id="clockInBtn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-4 rounded-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none">
              <i class="bi bi-play-circle mr-2"></i> Clock In
            </button>
            <button id="clockOutBtn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-4 rounded-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none">
              <i class="bi bi-stop-circle mr-2"></i> Clock Out
            </button>
          </div>

          <!-- Break Buttons (Phase 3 Stage 2) -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
            <button id="breakInBtn" class="d-none bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-4 rounded-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none">
              <i class="bi bi-pause-circle mr-2"></i> Start Break
            </button>
            <button id="breakOutBtn" class="d-none bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-xl transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none">
              <i class="bi bi-play-fill mr-2"></i> End Break
            </button>
          </div>

          <!-- Message -->
          <div id="message" class="hidden mt-4 px-6 py-4 rounded-xl"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Idle Screen Overlay -->
  <div id="idleOverlay" class="idle-overlay hidden">
    <div class="text-center text-white">
      <i class="bi bi-moon-stars text-6xl mb-4"></i>
      <h2 class="text-3xl font-bold mb-2">Screen Dimmed</h2>
      <p class="text-xl">Touch anywhere to wake</p>
    </div>
  </div>

  <!-- System Status Indicator (Step 5: Production Readiness) -->
  <div id="systemStatus" class="status-indicator">Online</div>

  <!-- Phase 3 Stage 2: Modular kiosk with break tracking -->
  <script type="module" src="js/kiosk/index.js"></script>
</body>
</html>
